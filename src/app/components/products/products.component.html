<div class="container-fluid">
  <section class="bg-primary text-white py-5">
    <div class="container text-center">
      <h1 class="display-4 fw-bold mb-3">
        <i class="bi bi-box me-3"></i>
        Galería de Productos
      </h1>
      <p class="lead">
        Descubre la mejor selección de electrónicos, audio, fotografía y más en ElectroHub
      </p>
      <div class="alert alert-info d-inline-block" role="alert">
        <i class="bi bi-info-circle me-2"></i>
        <strong>Acceso Protegido:</strong> Solo usuarios autenticados pueden ver los productos
      </div>
    </div>
  </section>

  <section class="py-4 bg-light">
    <div class="container">
      <div class="row justify-content-center">
        <div class="col-md-6">
          <div class="input-group">
            <span class="input-group-text bg-white">
              <i class="bi bi-search text-muted"></i>
            </span>
            <input 
              type="text" 
              class="form-control form-control-lg"
              placeholder="Buscar productos..." 
              [(ngModel)]="searchTerm"
              (input)="onSearchChange()"
            >
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="py-5">
    <div class="container">
      @if (loading) {
        <div class="text-center py-5">
          <div class="spinner-border text-primary" role="status" style="width: 3rem; height: 3rem;">
            <span class="visually-hidden">Cargando...</span>
          </div>
          <p class="mt-3 text-muted">Cargando galería de productos...</p>
        </div>
      } @else if (error) {
        <div class="alert alert-danger text-center" role="alert">
          <i class="bi bi-exclamation-triangle display-4 d-block mb-3"></i>
          <h5>Error al cargar productos</h5>
          <p class="mb-3">{{ error }}</p>
          <button (click)="loadProducts()" class="btn btn-outline-danger">
            <i class="bi bi-arrow-clockwise me-2"></i>
            Intentar de nuevo
          </button>
        </div>
      } @else if (filteredProducts.length === 0) {
        <div class="text-center py-5">
          <div class="display-1 text-muted mb-3">
            <i class="bi bi-search"></i>
          </div>
          <h4 class="text-muted mb-3">No se encontraron productos</h4>
          <p class="text-muted mb-4">
            No se encontraron productos que coincidan con tu búsqueda.
          </p>
          <button (click)="clearFilters()" class="btn btn-primary">
            <i class="bi bi-arrow-left me-2"></i>
            Ver todos los productos
          </button>
        </div>
      } @else {
        <div class="row g-4">
          @for (product of filteredProducts; track product.id) {
            <div class="col-md-6 col-lg-4">
              <div class="card h-100 border-0 shadow-sm product-card">
                <div class="position-relative">
                  <img [src]="product.image" 
                       [alt]="product.name" 
                       class="card-img-top" 
                       style="height: 200px; object-fit: cover;">
                  <div class="position-absolute top-0 end-0 m-2">
                    <span class="badge bg-primary fs-6">{{ formatPrice(product.price) }}</span>
                  </div>
                  <div class="position-absolute bottom-0 start-0 m-2">
                    <span class="badge" 
                          [class]="product.stock < 20 ? 'bg-danger' : 'bg-success'">
                      Stock: {{ product.stock }}
                    </span>
                  </div>
                </div>
                
                <div class="card-body d-flex flex-column">
                  <div class="mb-2">
                    <h5 class="card-title fw-bold">{{ product.name }}</h5>
                    <div class="d-flex align-items-center mb-2">
                      <div class="text-warning me-2">
                        @for (star of getStarRating(product.rating); track $index) {
                          <i class="bi" [class]="star === '★' ? 'bi-star-fill' : 'bi-star'"></i>
                        }
                      </div>
                      <small class="text-muted">({{ product.rating }})</small>
                    </div>
                  </div>
                  
                  <p class="card-text text-muted flex-grow-1">
                    {{ product.description | slice:0:100 }}{{ product.description.length > 100 ? '...' : '' }}
                  </p>
                  
                  <div class="mt-auto">
                    <div class="d-flex align-items-center justify-content-between mb-2">
                      <span class="badge bg-secondary">
                        <i class="bi bi-tag me-1"></i>
                        {{ product.category }}
                      </span>
                    </div>
                    
                    <div class="d-flex align-items-center justify-content-between">
                      <span class="h5 text-primary fw-bold mb-0">
                        {{ formatPrice(product.price) }}
                      </span>
                      <button class="btn btn-primary btn-sm">
                        <i class="bi bi-cart-plus me-1"></i>
                        Agregar
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          }
        </div>
        
        <div class="text-center mt-5">
          <div class="alert alert-info d-inline-block" role="alert">
            <i class="bi bi-info-circle me-2"></i>
            Mostrando <strong>{{ filteredProducts.length }}</strong> de <strong>{{ products.length }}</strong> productos
            @if (filteredProducts.length < products.length) {
              <button (click)="clearFilters()" class="btn btn-sm btn-outline-info ms-3">
                Ver todos los productos
              </button>
            }
          </div>
        </div>
      }
    </div>
  </section>
</div> 